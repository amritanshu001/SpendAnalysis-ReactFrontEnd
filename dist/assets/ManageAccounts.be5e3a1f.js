import{r as a,j as o,a as e,b as j,c as Q,R as W,H as X,z as Z,f as x,L as H}from"./index.30f654d1.js";import{T as ee,a as ne}from"./Table.c6641f90.js";import{F as te,d as oe}from"./Add.f01af2d2.js";import{u as B}from"./useHTTP.95e3c505.js";import{I as ce}from"./IconButton.be6bb1bd.js";import{u as ae}from"./useDispatch.e7edbe39.js";import"./Backdrop.47d56946.js";const se="_loading_as8xu_1",re="_error_as8xu_15",le="_container_as8xu_27",M={loading:se,error:re,container:le},ie="_form_1r8ux_1",ue="_inputs_1r8ux_33",de="_readonly_1r8ux_43",me="_checkbox_1r8ux_77",he="_actions_1r8ux_93",g={form:ie,inputs:ue,readonly:de,checkbox:me,actions:he},_e=({data:t,header:l,loading:s,error:k,onSave:r,onCancel:b})=>{const[m,C]=a.exports.useState(t.account_no),[A,f]=a.exports.useState(t.bank_name),[h,S]=a.exports.useState(t.active==="Yes"),[_,p]=a.exports.useState(t.joint==="Yes"),c=v=>{p(v.target.checked)},T=v=>{v.preventDefault(),r(t.id,_)};return o("form",{className:g.form,onSubmit:T,children:[o("div",{className:g.inputs,children:[o("div",{className:g.readonly,children:[e("label",{htmlFor:"account_no",children:"Account#"}),e("input",{id:"account_no",readOnly:!0,value:m})]}),o("div",{className:g.readonly,children:[e("label",{htmlFor:"bank_name",children:"Bank Name"}),e("input",{id:"bank_name",readOnly:!0,value:A})]})]}),o("div",{className:g.checkbox,children:[o("div",{children:[e("input",{type:"checkbox",defaultChecked:h,disabled:!0}),e("label",{children:"Active"})]}),o("div",{onClick:c,children:[e("input",{type:"checkbox",checked:_,onChange:c}),e("label",{children:"Joint"})]})]}),o("div",{className:g.actions,children:[e("button",{type:"button",onClick:b,children:"Cancel"}),e("button",{type:"submit",children:s?"Saving...":"Save Changes"})]}),k&&e("p",{children:props.error})]})},pe="_form_m74vf_1",be="_message_m74vf_19",fe="_actions_m74vf_31",E={form:pe,message:be,actions:fe,"imp-button":"_imp-button_m74vf_71"},ge=t=>o("form",{onSubmit:s=>{s.preventDefault(),t.onDelete(t.account.id)},className:E.form,children:[o("div",{children:[o("p",{children:["Account# ",t.account.account_no," will be deleted!"]}),e("p",{className:E.message,children:" Do you want to proceed?"})]}),o("div",{className:E.actions,children:[e("button",{type:"button",onClick:t.onCancel,children:"Cancel"}),e("button",{type:"submit",className:E["imp-button"],children:t.loading?"Deleting...":"Confirm Delete"})]})]}),ke="_form_fnqy0_1",Ce="_inputs_fnqy0_33",Ae="_readonly_fnqy0_43",ve="_checkbox_fnqy0_111",ye="_actions_fnqy0_127",N={form:ke,inputs:Ce,readonly:Ae,checkbox:ve,actions:ye},xe=t=>e("option",{value:t.id,children:t.bank_name},t.id),Ne=t=>{const l=j(c=>c.banks.banks),[s,k]=a.exports.useState(0),[r,b]=a.exports.useState(""),[m,C]=a.exports.useState(!1),[A,f]=a.exports.useState(null),h=c=>{k(c.target.value)},S=c=>{C(c.target.checked)},_=c=>{b(c.target.value)},p=c=>{if(c.preventDefault(),r.length===0){f("Account Number cannot be blank");return}if(s===0){f("Please sent a Bank");return}f(null),t.onCreate(s,r,m)};return o("form",{className:N.form,onSubmit:p,children:[o("div",{className:N.readonly,children:[e("label",{children:"Account#"}),e("input",{type:"text",onChange:_,value:r})]}),o("div",{className:N.readonly,children:[e("label",{htmlFor:"bank_name",children:"Bank Name"}),o("select",{id:"bank_name",value:s,onChange:h,children:[e("option",{value:0,children:"---"}),l.map(xe)]})]}),e("div",{className:N.checkbox,children:o("div",{children:[e("input",{type:"checkbox",checked:m,onChange:S}),e("label",{children:"Joint"})]})}),o("div",{className:N.actions,children:[e("button",{type:"button",onClick:t.onCancel,children:"Cancel"}),e("button",{type:"submit",children:t.loading?"Creating...":"Create Account"})]}),t.error&&e("p",{children:t.error})]})},q=[{name:"Account#",tech_name:"account_no"},{name:"Bank",tech_name:"bank_name"},{name:"Active",tech_name:"active"},{name:"Joint",tech_name:"joint"}],Te=t=>{const l=j(n=>n.userAuth.authToken),s=j(n=>n.userAccounts.userAccounts),k=j(n=>n.formModal.showModal),r=ae(),[b,m]=a.exports.useState({}),[C,A]=a.exports.useState({}),[f,h]=a.exports.useState(!1),S=a.exports.useCallback(n=>{const i=[];for(let u in n){const d={};d.id=n[u].account_id,d.account_no=n[u].account_no,d.active=n[u].active?"Yes":"No",d.joint=n[u].joint?"Yes":"No",d.bank_name=n[u].bank_dets.bank_name,i.push(d)}r(Q.setUserAccounts({accounts:i}))},[]),{isloading:_,error:p,sendRequest:c,resetError:T}=B(S);a.exports.useEffect(()=>{if(s.length===0){const n={url:x+"/accounts",headers:{Authorization:"Bearer "+l}};c(n)}},[l,c,s]);const v=n=>{m(n),r(H.showModal())},R=n=>{A(n),r(H.showModal())},y=()=>{A({}),m({}),h(!1),r(H.hideModal())};let D;_&&(D=e("p",{className:M.loading,children:"Loading...."})),p&&(D=e("p",{className:M.error,children:p})),!_&&!p&&s&&(D=e(ne,{header:q,body:s,editable:!0,onEdit:v,toDelete:!0,onDelete:R}));const F=a.exports.useCallback(n=>{const i={url:x+"/accounts",headers:{Authorization:"Bearer "+l}};c(i),y()},[]),{isloading:$,error:w,sendRequest:J,resetError:Se}=B(F),z=(n,i)=>{const u={url:x+"/accounts/"+n,method:"PUT",body:{joint:i},headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};J(u)},{isloading:I,error:L,sendRequest:O}=B(F),P=n=>{const i={url:x+"/accounts/"+n,method:"DELETE",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"}};O(i)},U=()=>{h(!0),r(H.showModal())},{isloading:Y,error:V,sendRequest:G}=B(F),K=(n,i,u)=>{const d={url:x+"/accounts",method:"POST",headers:{Authorization:"Bearer "+l,"Content-Type":"application/json"},body:{joint:u,bank:n,account_no:i}};G(d),h(!1)};return o(W.Fragment,{children:[k&&o(te,{onBackdropClick:y,children:[Object.keys(b).length>0&&e(_e,{data:b,header:q,onCancel:y,onSave:z,loading:$,error:w}),Object.keys(C).length>0&&e(ge,{account:C,onCancel:y,onDelete:P,loading:I,error:L}),f&&e(Ne,{onCancel:y,onCreate:K,loading:Y,error:V})]}),o(X,{children:["My Accounts",e(ee,{title:"Add New Account",placement:"top-start",arrow:!0,children:e(ce,{color:"primary","aria-label":"add",onClick:U,children:e(oe,{})})})]}),e(Z,{className:M.container,children:D})]})};export{Te as default};
